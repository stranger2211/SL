Experiment No. 3A
1. Aim
To study IP spoofing and ARP spoofing over a local area network.

2. Theory
2.1 IP Spoofing
2.1.1 What is Spoofing?
Spoofing attacks involve impersonating another device or user on a network to steal data, spread malware, or bypass access controls.

2.1.2 What is IP Spoofing?
IP spoofing involves sending IP packets from a false source address to disguise the sender. This technique is often used in denial-of-service attacks to overload targets with packets that appear to come from legitimate sources.

2.1.3 Simulation of IP Spoofing Attack Using Netkit
In this experiment, we simulate an IP spoofing attack on a LAN with three workstations:

PC1 (192.168.1.11): Attacker
PC2 (192.168.1.12): Spoofed Source
PC3 (192.168.1.13): Victim
Steps:

Create a LAN network with three workstations using Netkit:

bash
Copy code
vstart pc1 --eth0=A
vstart pc2 --eth0=A
vstart pc3 --eth0=A
Assign IP addresses to each PC:

bash
Copy code
ifconfig eth0 192.168.1.11  # For PC1
ifconfig eth0 192.168.1.12  # For PC2
ifconfig eth0 192.168.1.13  # For PC3
Ping from PC1 to PC3 to verify connectivity.

Spoof the IP address of PC2 on PC1:

bash
Copy code
iptables -t nat -A POSTROUTING -p icmp -j SNAT --to-source 192.168.1.12
Use tcpdump on PC2 to capture packets sent back from PC3.

Ping PC3 from PC1. PC3 responds to PC2 instead of PC1 due to the spoofed IP address.

2.2 ARP Spoofing
2.2.1 What is ARP Spoofing?
ARP spoofing involves sending fake ARP messages to link the attackerâ€™s MAC address with the IP address of a legitimate host. This can lead to data being sent to the attacker instead.

2.2.2 Simulation of ARP Spoofing Attack

Install arpwatch to monitor Ethernet traffic:

bash
Copy code
sudo apt-get install arpwatch
Check arpwatch status to confirm it is running.

Monitor changes in IP and MAC addresses using:

bash
Copy code
tail -f /var/log/syslog
Ping another node in the LAN to establish the IP-MAC pairing.

Change the MAC address of your system using:

bash
Copy code
ifconfig eth0 hw ether <new_mac_address>
Ping again and observe changes in /var/log/syslog.

3. Conclusion
We successfully simulated IP spoofing and ARP spoofing attacks on a local area network. The use of tools like arpwatch proved effective for monitoring network activity, allowing us to track changes in IP and MAC address pairings.
