

Experiment No. 06: Intrusion Detection System - SNORT
Aim:
To study the Intrusion Detection System (IDS) using Snort and analyze its logs.

Software Required:

Ubuntu 14.04 OS
Theory:
Snort is a widely used Network Intrusion Detection System (NIDS) that monitors network traffic and detects suspicious activities or intrusions using signature-based detection. It operates in two modes:

Packet Sniffing Mode: Passively looks at network traffic without any specific action.
Network Intrusion Detection Mode: Actively monitors traffic and blocks unwanted packets using pre-configured rules.
Snort can detect various types of attacks, malware infections, and compromised systems, making it a crucial tool in network security.

Steps for Installing and Configuring Snort:
Prepare the System for Installation:

bash
Copy code
sudo apt-get update
sudo apt-get dist-upgrade
Install Snort:

bash
Copy code
sudo apt-get install snort
Verify the installation by checking the version:

bash
Copy code
snort -V
Edit Snort Configuration Files:

Set up the HOME_NET value in the configuration file to define the protected network.
bash
Copy code
sudo vi +45 /etc/snort/snort.conf
Example:

bash
Copy code
ipvar HOME_NET 192.168.43.130/24
Update rule paths in the configuration file:
bash
Copy code
sudo vi +104 /etc/snort/snort.conf
Make sure the following lines look like this:

bash
Copy code
var RULE_PATH /etc/snort/rules
var SO_RULE_PATH /etc/snort/so_rules
var PREPROC_RULE_PATH /etc/snort/preproc_rules
var WHITE_LIST_PATH /etc/snort/rules/iplists
var BLACK_LIST_PATH /etc/snort/rules/iplists
Include rules by uncommenting the 545th line:
bash
Copy code
sudo vi +545 /etc/snort/snort.conf
bash
Copy code
include $RULE_PATH/local.rules
Create a Custom Test Rule:

Edit the local rules file and add the following rule to detect ICMP Echo Requests (ping):

bash
Copy code
sudo gedit /etc/snort/rules/local.rules
Add this rule:

bash
Copy code
alert icmp any any -> $HOME_NET any (msg:"ICMP test"; sid:1000001; rev:1;)
Explanation of the rule:

alert: Action to generate an alert.
icmp any any -> $HOME_NET any: Detect ICMP (ping) from any source to the home network.
msg:"ICMP test": Message to display when the rule is triggered.
sid:1000001: Rule ID.
rev:1: Rule revision number.
Testing and Running Snort:
Test Snort Configuration:

bash
Copy code
sudo snort -T -c /etc/snort/snort.conf
Run Snort in IDS Mode: Start Snort in IDS mode and display alerts to the console:

bash
Copy code
sudo snort -A console -c /etc/snort/snort.conf
While Snort is in listening mode, ping the machine from another system. You should see alerts related to the ICMP test rule on the console.
Log Analysis: Snort logs all alerts and activity in the /var/log/snort directory. You can view the logs using the following command:

bash
Copy code
sudo cat /var/log/snort/alert
Conclusion:
We have successfully studied Snort as an Intrusion Detection System (IDS) capable of analyzing network traffic, detecting various types of attacks, and logging them. Additionally, we created a custom rule to generate alerts for ICMP packets and analyzed the logs generated by Snort.




